(()=>{var Re=Object.create;var B=Object.defineProperty;var Pe=Object.getOwnPropertyDescriptor;var Ae=Object.getOwnPropertyNames,Q=Object.getOwnPropertySymbols,_e=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty,Ne=Object.prototype.propertyIsEnumerable;var Z=(e,t,n)=>t in e?B(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,b=(e,t)=>{for(var n in t||(t={}))v.call(t,n)&&Z(e,n,t[n]);if(Q)for(var n of Q(t))Ne.call(t,n)&&Z(e,n,t[n]);return e};var O=(e,t)=>()=>(e&&(t=e(e=0)),t);var Ie=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Me=(e,t,n,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Ae(t))!v.call(e,r)&&r!==n&&B(e,r,{get:()=>t[r],enumerable:!(o=Pe(t,r))||o.enumerable});return e};var je=(e,t,n)=>(n=e!=null?Re(_e(e)):{},Me(t||!e||!e.__esModule?B(n,"default",{value:e,enumerable:!0}):n,e));var j=(e,t,n)=>new Promise((o,r)=>{var c=d=>{try{s(n.next(d))}catch(a){r(a)}},f=d=>{try{s(n.throw(d))}catch(a){r(a)}},s=d=>d.done?o(d.value):Promise.resolve(d.value).then(c,f);s((n=n.apply(e,t)).next())});function R(e){if(e==null||typeof e!="object")return!1;let t=Object.getPrototypeOf(e);return t==null||t===Object.prototype}var V=O(()=>{});var ee=O(()=>{V()});var te=O(()=>{ee()});function y(e){return e!=null&&e.kind===3}var ne=O(()=>{});function K(e,{strict:t=!0,components:n}={}){let o=0,r={strict:t,mounted:!1,channel:e,children:De,nodes:new WeakSet,parents:new WeakMap,tops:new WeakMap,components:new WeakMap,fragments:new WeakMap};t&&Object.freeze(n);let c={kind:0,options:t?Object.freeze({strict:t,components:n}):{strict:t,components:n},get children(){return r.children},createComponent(f,...s){if(n&&n.indexOf(f)<0)throw new Error(`Unsupported component: ${f}`);let[d,a,...i]=s,p=d!=null?d:{},m=[],l={};if(d)for(let u of Object.keys(d))u!=="children"&&(l[u]=k(de(d[u])));if(a)if(Array.isArray(a))for(let u of a)m.push(h(u,c));else{m.push(h(a,c));for(let u of i)m.push(h(u,c))}let C=`${o++}`,g={externalProps:t?Object.freeze(p):p,internalProps:l,children:t?Object.freeze(m):m},x=b({kind:1,get children(){return g.children},get props(){return g.externalProps},get remoteProps(){return g.internalProps},remove:()=>oe(x),updateProps:u=>ze(x,u,g,r),append:(...u)=>S(x,u.map(E=>h(E,c)),g,r),appendChild:u=>w(x,h(u,c),g,r),removeChild:u=>D(x,u,g,r),replaceChildren:(...u)=>H(x,u.map(E=>h(E,c)),g,r),insertBefore:(u,E)=>P(x,h(u,c),E,g,r),insertChildBefore:(u,E)=>P(x,h(u,c),E,g,r)},z);r.components.set(x,g),Object.defineProperty(x,"type",{value:f,configurable:!1,writable:!1,enumerable:!0}),L(x,r),U(x,C,c);for(let u of g.children)I(x,u,r);return x},createText(f=""){let s=`${o++}`,d={text:f},a=p=>Be(i,p,d,r),i=b({kind:2,get text(){return d.text},update:a,updateText:a,remove:()=>oe(i)},z);return L(i,r),U(i,s,c),i},createFragment(){let f=`${o++}`,s={children:t?Object.freeze([]):[]},d=b({kind:3,get children(){return s.children},append:(...a)=>S(d,a.map(i=>h(i,c)),s,r),appendChild:a=>w(d,h(a,c),s,r),removeChild:a=>D(d,a,s,r),replaceChildren:(...a)=>H(d,a.map(i=>h(i,c)),s,r),insertBefore:(a,i)=>P(d,h(a,c),i,s,r),insertChildBefore:(a,i)=>P(d,h(a,c),i,s,r)},z);return r.fragments.set(d,s),L(d,r),U(d,f,c),d},append:(...f)=>S(c,f.map(s=>h(s,c)),r,r),appendChild:f=>w(c,h(f,c),r,r),replaceChildren:(...f)=>H(c,f.map(s=>h(s,c)),r,r),removeChild:f=>D(c,f,r,r),insertBefore:(f,s)=>P(c,h(f,c),s,r,r),insertChildBefore:(f,s)=>P(c,h(f,c),s,r,r),mount(){return r.mounted?Promise.resolve():(r.mounted=!0,Promise.resolve(e(0,r.children.map(M))))}};return c}function Fe(e,{tops:t}){var n;return((n=t.get(e))===null||n===void 0?void 0:n.kind)===0}function fe(e,t){let n=o=>{if("children"in o)for(let r of o.children)t(r),n(r)};n(e)}function N(e,t,{remote:n,local:o}){let{mounted:r,channel:c}=t;r&&(e.kind===0||Fe(e,t))&&n(c),o()}function Be(e,t,n,o){return N(e,o,{remote:r=>r(3,e.id,t),local:()=>{n.text=t}})}function ze(e,t,n,o){let{strict:r}=o,{internalProps:c,externalProps:f}=n,s={},d=[],a=!1;for(let i of Object.keys(t)){if(i==="children")continue;let p=f[i],m=t[i],l=c[i],C=de(m);if(l===C&&(C==null||typeof C!="object"))continue;let[g,x]=$(l,C);x&&d.push(...x),g!==T&&(a=!0,s[i]=g,y(p)&&W(p,o),y(m)&&I(e,m,o))}return N(e,o,{remote:i=>{a&&i(4,e.id,s)},local:()=>{let i=b(b({},f),t);n.externalProps=r?Object.freeze(i):i,n.internalProps=b(b({},n.internalProps),s);for(let[p,m]of d)p[_]=m}})}function $(e,t,n=new Set){return n.has(e)?[T]:typeof e=="function"&&_ in e?(n.add(e),[typeof t=="function"?T:k(t),[[e,t]]]):Array.isArray(e)?(n.add(e),Ue(e,t,n)):R(e)&&!y(e)?(n.add(e),Le(e,t,n)):[e===t?T:t]}function k(e,t=new Map){let n=t.get(e);if(n)return n;if(y(e))return t.set(e,e),e;if(Array.isArray(e)){let o=[];t.set(e,o);for(let r of e)o.push(k(r,t));return o}if(R(e)){let o={};t.set(e,o);for(let r of Object.keys(e))o[r]=k(e[r],t);return o}if(typeof e=="function"){let o=(...r)=>o[_](...r);return Object.defineProperty(o,_,{enumerable:!1,configurable:!1,writable:!0,value:e}),t.set(e,o),o}return e}function A(e,t=new Set){if(!t.has(e)){if(t.add(e),Array.isArray(e))return e.reduce((n,o)=>{let r=A(o,t);return r?[...n,...r]:n},[]);if(R(e))return Object.keys(e).reduce((n,o)=>{let r=A(e[o],t);return r?[...n,...r]:n},[]);if(typeof e=="function")return _ in e?[e]:void 0}}function oe(e){var t;(t=e.parent)===null||t===void 0||t.removeChild(e)}function S(e,t,n,o){for(let r of t)w(e,r,n,o)}function w(e,t,n,o){var r;let{nodes:c,strict:f}=o;if(!c.has(t))throw new Error("Cannot append a node that was not created by this remote root");let s=t.parent,d=(r=s==null?void 0:s.children.indexOf(t))!==null&&r!==void 0?r:-1;return N(e,o,{remote:a=>{a(1,e.id,d<0?e.children.length:e.children.length-1,M(t),s?s.id:!1)},local:()=>{I(e,t,o);let a;if(s){let i=ae(s,o),p=[...i.children];p.splice(d,1),s===e?a=p:(i.children=f?Object.freeze(p):p,a=[...n.children])}else a=[...n.children];a.push(t),n.children=f?Object.freeze(a):a}})}function H(e,t,n,o){for(let r of e.children)D(e,r,n,o);S(e,t,n,o)}function D(e,t,n,o){let{strict:r}=o,c=e.children.indexOf(t);if(c!==-1)return N(e,o,{remote:f=>f(2,e.id,c),local:()=>{W(t,o);let f=[...n.children];f.splice(f.indexOf(t),1),n.children=r?Object.freeze(f):f}})}function P(e,t,n,o,r){var c;let{strict:f,nodes:s}=r;if(!s.has(t))throw new Error("Cannot insert a node that was not created by this remote root");let d=t.parent,a=(c=d==null?void 0:d.children.indexOf(t))!==null&&c!==void 0?c:-1;return N(e,r,{remote:i=>{let p=n==null?e.children.length-1:e.children.indexOf(n);i(1,e.id,p<a||a<0?p:p-1,M(t),d?d.id:!1)},local:()=>{I(e,t,r);let i;if(d){let p=ae(d,r),m=[...p.children];m.splice(a,1),d===e?i=m:(p.children=f?Object.freeze(m):m,i=[...o.children])}else i=[...o.children];n==null?i.push(t):i.splice(i.indexOf(n),0,t),o.children=f?Object.freeze(i):i}})}function h(e,t){return typeof e=="string"?t.createText(e):e}function I(e,t,n){let{tops:o,parents:r}=n,c=e.kind===0?e:o.get(e);o.set(t,c),r.set(t,e),ie(t,n),fe(t,f=>{o.set(f,c),ie(f,n)})}function ie(e,t){if(e.kind!==1)return;let n=e.props;n&&Object.values(n).forEach(o=>{y(o)&&I(e,o,t)})}function W(e,t){let{tops:n,parents:o}=t;n.delete(e),o.delete(e),fe(e,r=>{n.delete(r),ce(r,t)}),ce(e,t)}function ce(e,t){if(e.kind!==1)return;let n=e.remoteProps;for(let o of Object.keys(n!=null?n:{})){let r=n[o];y(r)&&W(r,t)}}function L(e,{parents:t,tops:n,nodes:o}){o.add(e),Object.defineProperty(e,"parent",{get(){return t.get(e)},configurable:!0,enumerable:!0}),Object.defineProperty(e,"top",{get(){return n.get(e)},configurable:!0,enumerable:!0})}function M(e){return e.kind===2?{id:e.id,kind:e.kind,text:e.text}:{id:e.id,kind:e.kind,type:e.type,props:e.remoteProps,children:e.children.map(t=>M(t))}}function de(e){return y(e)?He(e):e}function He(e){return{id:e.id,kind:e.kind,get children(){return e.children.map(t=>M(t))}}}function ae(e,t){return e.kind===0?t:e.kind===3?t.fragments.get(e):t.components.get(e)}function U(e,t,n){Object.defineProperty(e,"id",{value:t,configurable:!0,writable:!1,enumerable:!1}),Object.defineProperty(e,"root",{value:n,configurable:!0,writable:!1,enumerable:!1})}function Le(e,t,n){if(!R(t)){var o;return[k(t),(o=A(e))===null||o===void 0?void 0:o.map(s=>[s,void 0])]}let r=!1,c=[],f={};for(let s in e){let d=e[s];if(!(s in t)){r=!0;let m=A(d);m&&c.push(...m.map(l=>[l,void 0]))}let a=t[s],[i,p]=$(d,a,n);p&&c.push(...p),i!==T&&(r=!0,f[s]=i)}for(let s in t)s in f||(r=!0,f[s]=k(t[s]));return[r?f:T,c]}function Ue(e,t,n){if(!Array.isArray(t)){var o;return[k(t),(o=A(e))===null||o===void 0?void 0:o.map(i=>[i,void 0])]}let r=!1,c=[],f=t.length,s=e.length,d=Math.max(s,f),a=[];for(let i=0;i<d;i++){let p=e[i],m=t[i];if(i<f){if(i>=s){r=!0,a[i]=k(m);continue}let[l,C]=$(p,m,n);if(C&&c.push(...C),l===T){a[i]=p;continue}r=!0,a[i]=l}else{r=!0;let l=A(p);l&&c.push(...l.map(C=>[C,void 0]))}}return[r?a:T,c]}var _,z,De,T,pe=O(()=>{te();ne();_="__current",z={},De=[];T=Symbol("ignore")});var me=O(()=>{pe()});var ue=O(()=>{me()});function le(){return(t,n)=>{var o;function r(...c){return j(this,null,function*(){if(c.length===1)return n(...c);let[{channel:f,components:s},d]=c,a=K(f,{components:s,strict:!0}),i=n(a,d);return typeof i=="object"&&i!=null&&"then"in i&&(i=yield i),a.mount(),i})}return(o=globalThis.shopify)===null||o===void 0||o.extend(t,r),r}}var he=O(()=>{ue()});var xe,G,Ce=O(()=>{he();xe=le(),G=xe});var Y,ge=O(()=>{Y="AdminBlock"});var X,Oe=O(()=>{X="BlockStack"});var q,be=O(()=>{q="Checkbox"});var J,ye=O(()=>{J="Form"});var Te=O(()=>{Ce();ge();Oe();be();ye()});var Ee=Ie(ke=>{"use strict";Te();var Ke="admin.product-details.block.render";G(Ke,(e,t)=>{var d,a;let n=(a=(d=t.data.selected)==null?void 0:d[0])==null?void 0:a.id;if(!n)return;let o=!0,r=e.createComponent(q,{name:"virtualTryOn",label:"Enable Banana Try-On for this product",checked:!0,onChange:i=>{o=i}}),c=e.createComponent(J,{onSubmit:()=>j(null,null,function*(){var i,p,m;try{let l=yield t.query(`mutation UpdateProductMetafield($input: ProductInput!) {
            productUpdate(input: $input) {
              product {
                id
                metafield(namespace: "custom", key: "virtual_tryon_enabled") {
                  value
                }
              }
              userErrors {
                field
                message
              }
            }
          }`,{variables:{input:{id:n,metafields:[{namespace:"custom",key:"virtual_tryon_enabled",type:"boolean",value:o.toString()}]}}});return((m=(p=(i=l==null?void 0:l.data)==null?void 0:i.productUpdate)==null?void 0:p.userErrors)==null?void 0:m.length)>0?{status:"error",errors:[{message:l.data.productUpdate.userErrors[0].message}]}:(r.updateProps({defaultValue:o}),{status:"success"})}catch(l){return{status:"error",errors:[{message:"Failed to save settings"}]}}})}),f=e.createComponent(X,{gap:"base"});f.appendChild(r),c.appendChild(f);let s=e.createComponent(Y,{title:"Banana Try-On"});s.appendChild(c),e.appendChild(s),t.query(`query GetProductMetafield($id: ID!) {
      product(id: $id) {
        metafield(namespace: "custom", key: "virtual_tryon_enabled") {
          value
        }
      }
    }`,{variables:{id:n}}).then(i=>{var l,C;let p=(C=(l=i==null?void 0:i.data)==null?void 0:l.product)==null?void 0:C.metafield,m=!p||p.value!=="false";o=m,r.updateProps({checked:m,defaultValue:m})})})});var It=je(Ee());})();
//# sourceMappingURL=virtual-tryon-settings.js.map
